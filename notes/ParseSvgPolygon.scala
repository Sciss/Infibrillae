val mmToPx = 96 / 25.4

// parse a "m .... z" svg path
def parseSvgPolygon(s: String): Seq[(Float, Float)] = {
  val s0 = s.trim.split(' ')
  require (s0.length > 2 && s0.head == "m" && s0.last == "z")
  val (xs, ys) = s0.tail.init.map { tup =>
    val Array(xs, ys) = tup.split(",")
    ((xs.toDouble * mmToPx).toFloat, (ys.toDouble * mmToPx).toFloat)
  } .unzip
  xs.toSeq.integrate zip ys.toSeq.integrate
}

val p11 = "m 156.29315,295.46399 -10.96131,-9.44941 2.26786,-10.77232 -2.26786,-10.20535 11.52828,-22.11161 10.01637,-21.35565 13.22916,-11.71726 6.99256,-21.16667 4.53572,-16.81994 8.69345,-5.48065 0.18899,-8.31549 20.22172,-22.86755 15.68601,-9.63839 4.9137,-9.63839 28.91518,-13.60715 20.78869,3.2128 14.1741,20.97768 2.12203,10.96131 5.24852,9.63839 6.42559,2.07887 3.59076,10.96131 0.0,16.06399 7.18156,19.27678 -3.77975,9.82738 7.55951,7.55953 9.82737,22.67857 -3.21278,5.48065 1.13392,8.69345 2.64583,17.95387 11.90625,40.06548 2.45684,17.00893 6.80358,26.08035 -3.59077,21.35566 10.01636,25.5134 3.59077,21.9226 1.88989,21.92261 -7.74851,20.03274 -6.80357,13.22917 -17.19792,7.18156 -30.42708,-17.5759 -36.47469,-18.14285 -9.44941,-18.89882 -45.16817,-57.2634 -15.68601,-13.79611 -28.15923,-22.67858 0.0,-6.80357 -18.70982,-17.95386 z"
val p13 = "m 76.973622,438.5172 13.363477,-19.51066 6.414468,-26.99422 9.888973,-9.88899 14.69983,-50.51393 5.61265,-12.82893 0.26727,-18.17434 6.41447,-24.05425 5.34539,-37.95228 11.75986,-22.98518 7.75082,-15.23436 0.53454,-13.89802 9.6217,-18.70886 33.67596,-28.59784 24.5888,11.49259 -0.80181,32.60688 -7.75082,11.49259 8.28536,22.18337 -4.54358,13.63074 6.41446,20.57976 12.56167,22.71792 4.00904,45.16853 20.31249,33.4087 0.26726,13.63075 9.6217,11.22532 10.95807,-4.54358 29.13237,32.07234 17.63979,0.26728 8.55263,12.29439 -1.60364,16.83798 -16.30343,35.27957 -31.27053,18.97615 -11.4926,18.44159 1.06908,16.83798 -19.51067,28.59783 -18.4416,42.76312 -26.86058,0.53454 -8.35218,19.24341 -23.05199,-0.80181 -1.60362,-38.4868 -16.57071,-30.73601 -57.46295,-62.80833 z"
val p15 = "m 60.476191,433.65208 7.559524,-40.06548 -5.669642,-38.93153 2.645833,-43.0893 -7.559524,-19.65476 1.133927,-24.19048 17.386906,-33.63988 1.511903,-50.27083 38.553572,-38.93155 6.42559,-24.56845 35.15179,-32.127982 19.65476,-17.008919 78.99702,-15.119051 96.76191,10.20535 55.5625,27.214292 25.32441,20.03274 32.88392,11.33928 7.55952,28.34822 14.36312,14.74107 53.29462,89.20238 15.49704,28.7262 -15.11906,41.95535 -13.60715,59.72024 -14.74107,25.70237 -6.80355,34.39583 -13.22917,29.10417 -20.03274,13.60715 -21.16667,33.63989 -15.49704,7.9375 -19.65476,54.05059 -52.1607,54.42858 -28.34822,31.37201 -36.66368,13.60715 -37.79763,1.51191 -54.42857,-48.00298 -65.76786,-49.89285 -41.95535,-58.20833 -15.875003,-52.16073 z"
val p15b = "m 165.17559,381.49136 -9.82738,-59.72022 8.69345,-16.25298 5.48066,-39.30954 12.6622,1.32294 7.74851,-51.78275 -11.15029,-12.66221 32.88392,-34.39583 20.41072,-10.20536 22.1116,6.99256 33.45091,-29.67113 17.76487,-54.806542 14.74107,3.401782 -1.7009,36.47471 21.92264,29.29314 12.28423,8.1265 32.88393,73.89434 15.49701,1.13393 5.10268,16.25298 -17.19792,12.4732 2.26788,43.65624 11.33927,36.47472 1.13393,25.5134 -18.52086,7.37053 -40.8214,78.24107 -17.7649,34.39584 -62.74404,23.43451 -26.08036,4.15774 -5.10267,-17.38688 -20.6942,-34.01787 -16.91444,-4.15775 -15.49702,-13.9851 -14.74107,-39.30952 -7.55952,-18.70983 z"

val pts = parseSvgPolygon(p15b)
val ptsS = pts.grouped(4).map { g => g.map { case (x, y) => s"(${x}f,${y}f)" }.mkString("  ", ", ", ",") }.mkString("Vector(\n", "\n", "\n)")
println(ptsS)
